<!doctype html>
<html lang="th" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coder Showcase 2026 - Voting System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Prompt', sans-serif; background: #f4f7fb; color: #1e293b; }
    .candidate-card { transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1); border: 2px solid white; cursor: pointer; background: white; }
    .candidate-card:hover { transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
    .candidate-card.selected { border-color: #3b82f6; background: #eff6ff; }
    .group-section { background: rgba(255, 255, 255, 0.6); border-radius: 2rem; padding: 1.5rem; border: 1px solid #e2e8f0; margin-bottom: 2rem; }
    .status-dot { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 6px; }
    .dot-waiting { background: #cbd5e1; }
    .dot-done { background: #10b981; animation: pulse 2s infinite; }
    @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    .sticky-bar { position: fixed; bottom: 0; left: 0; right: 0; background: white; border-top: 1px solid #e2e8f0; z-index: 50; padding: 1rem; }
  </style>
</head>
<body class="pb-32">

  <div id="app" class="max-w-5xl mx-auto px-4 pt-10">
    <header class="text-center mb-12">
      <div class="inline-block px-4 py-1 mb-4 rounded-full bg-blue-100 text-blue-600 text-xs font-bold tracking-widest uppercase">
        Project Showcase 15 Feb 2026
      </div>
      <h1 class="text-4xl font-bold text-slate-800 mb-4">เลือกผลงานที่คุณชื่นชอบ</h1>
      <p class="text-slate-500 text-lg">กติกา: โปรดเลือกนักพัฒนาที่คุณประทับใจ **กลุ่มละ 2 ท่าน**</p>
    </header>

    <div class="max-w-md mx-auto mb-16">
      <div class="bg-white p-2 rounded-3xl shadow-sm border border-slate-200">
        <input type="email" id="input-email" oninput="validate()" 
               class="w-full px-6 py-4 rounded-2xl focus:outline-none text-center text-lg" 
               placeholder="ใส่อีเมลของคุณเพื่อเริ่มโหวต">
      </div>
    </div>

    <div id="screen-voting" class="space-y-8">
      <section class="group-section">
        <div class="flex items-center justify-between mb-6 px-2">
          <h2 class="text-2xl font-bold text-blue-600">กลุ่ม Genius (5-7 ปี)</h2>
          <span id="badge-Genius" class="bg-slate-100 text-slate-500 px-4 py-1 rounded-full text-sm font-bold">0 / 2</span>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="grid-Genius"></div>
      </section>

      <section class="group-section">
        <div class="flex items-center justify-between mb-6 px-2">
          <h2 class="text-2xl font-bold text-purple-600">กลุ่ม Wizard (8-10 ปี)</h2>
          <span id="badge-Wizard" class="bg-slate-100 text-slate-500 px-4 py-1 rounded-full text-sm font-bold">0 / 2</span>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="grid-Wizard"></div>
      </section>

      <section class="group-section">
        <div class="flex items-center justify-between mb-6 px-2">
          <h2 class="text-2xl font-bold text-emerald-600">กลุ่ม Hero (11-14 ปี)</h2>
          <span id="badge-Hero" class="bg-slate-100 text-slate-500 px-4 py-1 rounded-full text-sm font-bold">0 / 2</span>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="grid-Hero"></div>
      </section>
    </div>

    <div id="screen-loading" class="hidden text-center py-24"><div class="animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-4"></div><p>กำลังบันทึกคะแนนโหวต...</p></div>
    <div id="screen-success" class="hidden text-center py-24"><h2 class="text-4xl font-bold text-green-600 mb-4">โหวตสำเร็จ!</h2><p class="text-slate-500 text-xl">ขอบคุณที่ร่วมเป็นแรงใจให้เด็กๆ ครับ</p></div>
  </div>

  <div class="sticky-bar shadow-2xl">
    <div class="max-w-md mx-auto">
      <div class="flex justify-center gap-4 mb-3 text-[10px] font-bold uppercase tracking-widest text-slate-400">
        <span id="ind-Genius"><span class="status-dot dot-waiting"></span>Genius</span>
        <span id="ind-Wizard"><span class="status-dot dot-waiting"></span>Wizard</span>
        <span id="ind-Hero"><span class="status-dot dot-waiting"></span>Hero</span>
      </div>
      <button id="btn-submit" disabled onclick="submitData()" 
              class="w-full py-4 rounded-2xl font-bold text-xl transition-all shadow-lg bg-blue-600 text-white disabled:bg-slate-200 disabled:text-slate-400">
        ยืนยันการโหวตทั้งหมด
      </button>
    </div>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwNQcRJjYV_j1CVHnLa-DVBye8J9dQM4CcpSAeMORJ9_uVsBhYFnxvvMNxmwiCRtjwKXg/exec";

    // ข้อมูลอัปเดตล่าสุดจากไฟล์ CSV
    const candidates = [
      { "id": 1, "name": "Neo (Touchphoom Anantakarn)", "group": "Hero", "project": "Dive: An Underwater Adventure" },
      { "id": 2, "name": "Meg (Mira Hsu)", "group": "Hero", "project": "Project" },
      { "id": 3, "name": "Kin (Pakin Hsu)", "group": "Wizard", "project": "Project" },
      { "id": 4, "name": "Marvin (Apipoom Hanjawanich)", "group": "Wizard", "project": "Survival Underwater in Ohio" },
      { "id": 5, "name": "Pete (PITCHAYUT KRUECHOTEKUL)", "group": "Wizard", "project": "Ocean Guardian" },
      { "id": 6, "name": "JulJul (Saranyapong Kanchanapangka)", "group": "Wizard", "project": "Exploring the deep ocean" },
      { "id": 7, "name": "Etienne (Tiberghien)", "group": "Wizard", "project": "The blox water" },
      { "id": 8, "name": "Aiden (Kritchanon Sivasri)", "group": "Wizard", "project": "The Secret Monster" },
      { "id": 9, "name": "Dylan", "group": "Hero", "project": "The Megalodon Hunt" },
      { "id": 10, "name": "Tyler (Tyler Saebae)", "group": "Genius", "project": "Sharky's Snack Time" },
      { "id": 11, "name": "Nine (Paratham Jameeken)", "group": "Wizard", "project": "Deep Blue World" },
      { "id": 12, "name": "Nuermek (Nuermek Teeraakararat)", "group": "Genius", "project": "My Ocean Friends Party" },
      { "id": 13, "name": "Preme2 (Premephaphan Ittipunsiri)", "group": "Wizard", "project": "Amazing Sea Creatures Quiz" },
      { "id": 14, "name": "Gin (Sasawat Lertsamart)", "group": "Hero", "project": "Submerged" },
      { "id": 15, "name": "Famous (Yannavut Sridawong)", "group": "Hero", "project": "บ้าน spongeBob" },
      { "id": 16, "name": "Tonmai (Nathakorn Somsanguan)", "group": "Hero", "project": "Dedo in the ocean" },
      { "id": 17, "name": "Matang (Tanawat Tangsupwattana)", "group": "Hero", "project": "ผู้กล้ากับดาบที่ถูกขโมยไป" },
      { "id": 18, "name": "Pingping (Narathorn Janvipast)", "group": "Hero", "project": "spongebob" },
      { "id": 19, "name": "Kenta (Wuttipat Tubsarn)", "group": "Hero", "project": "Ratatouille" },
      { "id": 20, "name": "Temim (Phuchanut Saengrayub)", "group": "Hero", "project": "ศึกผู้กล้าท้าคราเคน" },
      { "id": 21, "name": "Takky (Tatchakorn Sattawongsakul)", "group": "Hero", "project": "Super underwater" },
      { "id": 22, "name": "Pang pang (Komthorn Janvipast)", "group": "Hero", "project": "kraken" },
      { "id": 23, "name": "Tigger (Totchakorn Sattawongsakul)", "group": "Hero", "project": "Underwater adventure" },
      { "id": 24, "name": "L (Allen) (Allen Jarnyaharn)", "group": "Genius", "project": "Orange in the ocean" },
      { "id": 25, "name": "Parm & Prompt", "group": "Hero", "project": "Unshoot shark" },
      { "id": 26, "name": "Ren (Tarit Janjaemjaroon)", "group": "Wizard", "project": "El gran maja and Bloob" },
      { "id": 27, "name": "Miranda (Miranda Chen)", "group": "Wizard", "project": "Ginger the Clown fish" },
      { "id": 28, "name": "Gus (Akaradej Imarom)", "group": "Wizard", "project": "Fishy fishy" },
      { "id": 29, "name": "Eton (Chavin Rattanasophon)", "group": "Wizard", "project": "Find the fish" },
      { "id": 30, "name": "Winwin (Thanaphat ketthanasitthi)", "group": "Hero", "project": "Poseidon" },
      { "id": 31, "name": "Ran & Ray", "group": "Wizard", "project": "Lovely and ancient ocean" },
      { "id": 32, "name": "Rak (Weeralak saelim)", "group": "Hero", "project": "The sea" },
      { "id": 33, "name": "Captain (Suttidol Songsripipat)", "group": "Hero", "project": "layer of ocean" },
      { "id": 34, "name": "Khonkwan (Benjanut Srisuk)", "group": "Hero", "project": "Gigi's adventure" },
      { "id": 35, "name": "liangliang (Warinthon Limsathiranun)", "group": "Hero", "project": "Hungry sea monsters" },
      { "id": 36, "name": "Thun (Thun Iamthongthong)", "group": "Wizard", "project": "The hard part of sea turtle" }
    ];

    let selected = new Set();

    function render() {
      ['Genius', 'Wizard', 'Hero'].forEach(group => {
        const grid = document.getElementById(`grid-${group}`);
        grid.innerHTML = candidates.filter(c => c.group === group).map(c => `
          <div class="candidate-card p-6 rounded-3xl shadow-sm" id="c-${c.id}" onclick="selectCandidate(${c.id})">
            <div class="font-bold text-slate-800 mb-1">${c.name}</div>
            <div class="text-xs text-blue-500 font-medium uppercase tracking-tighter">${c.project}</div>
          </div>
        `).join('');
      });
    }

    function selectCandidate(id) {
      const c = candidates.find(item => item.id === id);
      const currentInGroup = Array.from(selected).filter(sid => candidates.find(i => i.id === sid).group === c.group);

      if (selected.has(id)) {
        selected.delete(id);
      } else {
        if (currentInGroup.length >= 2) {
          alert(`กลุ่ม ${c.group} โหวตได้เพียง 2 ท่านเท่านั้นครับ`);
          return;
        }
        selected.add(id);
      }
      updateUI();
    }

    function updateUI() {
      document.querySelectorAll('.candidate-card').forEach(el => el.classList.remove('selected'));
      selected.forEach(sid => document.getElementById(`c-${sid}`).classList.add('selected'));
      validate();
    }

    function validate() {
      const email = document.getElementById('input-email').value;
      const isValidEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
      const counts = { Genius: 0, Wizard: 0, Hero: 0 };
      
      selected.forEach(sid => counts[candidates.find(item => item.id === sid).group]++);

      let isAllComplete = true;
      ['Genius', 'Wizard', 'Hero'].forEach(g => {
        const badge = document.getElementById(`badge-${g}`);
        const indicator = document.getElementById(`ind-${g}`);
        badge.innerText = `${counts[g]} / 2`;
        
        if (counts[g] === 2) {
          badge.className = "bg-green-100 text-green-600 px-4 py-1 rounded-full text-sm font-bold";
          indicator.querySelector('.status-dot').className = "status-dot dot-done";
          indicator.className = "text-green-600 font-bold";
        } else {
          badge.className = "bg-slate-100 text-slate-500 px-4 py-1 rounded-full text-sm font-bold";
          indicator.querySelector('.status-dot').className = "status-dot dot-waiting";
          indicator.className = "text-slate-400 font-bold";
          isAllComplete = false;
        }
      });

      document.getElementById('btn-submit').disabled = !(isValidEmail && isAllComplete);
    }

    async function submitData() {
      const email = document.getElementById('input-email').value;
      const votes = Array.from(selected).map(id => {
        const c = candidates.find(i => i.id === id);
        return `[${c.group}] ${c.name}`;
      });

      document.getElementById('screen-voting').style.display = 'none';
      document.getElementById('screen-loading').classList.remove('hidden');

      try {
        await fetch(SCRIPT_URL, { 
          method: "POST", 
          mode: "no-cors",
          body: JSON.stringify({ email, votes }) 
        });
        localStorage.setItem('voted_showcase_2026', 'true');
        showScreen('success');
      } catch (e) {
        showScreen('success'); 
      }
    }

    function showScreen(id) {
      document.getElementById('screen-loading').classList.add('hidden');
      document.getElementById('screen-' + id).classList.remove('hidden');
      document.querySelector('.sticky-bar').style.display = 'none';
      window.scrollTo(0,0);
    }

    render();
  </script>
</body>
</html>
